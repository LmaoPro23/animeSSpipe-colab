Namespace(dataset_path='/media/sashi/DATA1/pictures/ACG-extra/training_data/yama_no_susume/few_shot_trainer/faces', dataset_name='yama', model_name='L_16', results_dir='results_training', image_size=128, batch_size=8, no_epochs=40, learning_rate=0.001, lr_scheduler='warmupCosine', epoch_decay=20, warmup_steps=1000, pretrained=False, checkpoint_path='../../animesion/classification_tagging/checkpoints/pretrained/danbooruFaces_L_16_image128_batch16_SGDlr0.001_ptTrue_seed0_warmupCosine_interTrue_mmFalse_textLenNone_maskNoneconstanttagtokenizingshufFalse_lastEpoch.ckpt', transfer_learning=True, load_partial_mode=None, log_freq=10, save_checkpoint_freq=5, no_cpu_workers=4, seed=0, interm_features_fc=True, debugging=False, exclusion_loss=False, temperature=1.0, exclusion_weight=0.01, exc_layers_dist=2, multimodal=False, max_text_seq_len=None, mask_schedule=None, mask_wu_percent=0.1, mask_cd_percent=0.5, ret_attn_scores=False, tokenizer='tag', masking_behavior='constant', shuffle_tokens=False, label_csv_name='labels.csv', use_test_set=False, patch_size=16, run_name='yama_L_16_image128_batch8_SGDlr0.001_ptFalse_seed0_warmupCosine_interTrue_mmFalse_textLenNone_maskNoneconstanttagtokenizingshufFalse')
ViTConfigExtended {
  "attention_probs_dropout_prob": 0.0,
  "classifier": "token",
  "fh": 16,
  "fw": 16,
  "gh": 8,
  "gw": 8,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "image_size": 128,
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "layer_norm_eps": 1e-12,
  "load_fc_layer": false,
  "max_text_seq_len": null,
  "model_type": "vit",
  "num_attention_heads": 16,
  "num_channels": 3,
  "num_classes": 21,
  "num_hidden_layers": 24,
  "patch_size": [
    16,
    16
  ],
  "pos_embedding_type": "learned",
  "pretrained_image_size": 224,
  "pretrained_num_channels": 3,
  "pretrained_num_classes": 21843,
  "representation_size": 1024,
  "seq_len": 65,
  "transformers_version": "4.9.1",
  "vocab_size": 30522
}

Epoch [1/40], Step [1/31] Loss: 3.46042180, LR: 0.00000100

Epoch [1/40], Step [11/31] Loss: 3.99258471, LR: 0.00001100

Epoch [1/40], Step [21/31] Loss: 3.37296987, LR: 0.00002100

