2023-12-01 20:27:46,879 - INFO - -------------Start stage 0-------------
2023-12-01 20:27:46,882 - INFO - Downloading images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 20:27:46,882 - INFO - Downloading images for hikikomari_kyuuketsuki_no_monmon to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 20:30:32,854 - INFO - Downloading images for flote_mascarail to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 20:30:33,043 - INFO - -------------Start stage 1-------------
2023-12-01 20:30:33,044 - INFO - Loading mobilenetv3_large_100 ...
2023-12-01 20:30:33,317 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw' ...
2023-12-01 20:30:33,320 - INFO - Compute embeddings for 97 images ...
2023-12-01 20:30:34,556 - INFO - Removing similar images ...
2023-12-01 20:30:34,558 - INFO - -------------Start stage 2-------------
2023-12-01 20:30:34,558 - INFO - Cropping individual characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/cropped ...
2023-12-01 20:32:04,515 - INFO - -------------Start stage 3-------------
2023-12-01 20:32:04,515 - INFO - Classifying characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/classified ...
2023-12-01 20:32:04,532 - INFO - Extracting feature of 358 images ...
2023-12-01 20:32:21,296 - INFO - Clustering ...
2023-12-01 20:32:21,538 - INFO - Cluster complete, with 13 clusters.
2023-12-01 20:32:21,538 - INFO - Current label count: {-1: 238, 0: 21, 1: 5, 2: 10, 3: 8, 4: 9, 5: 6, 6: 7, 7: 10, 8: 5, 9: 6, 10: 5, 11: 9, 12: 12, 13: 7}
2023-12-01 20:32:21,539 - INFO - Extracting feature of 219 images ...
2023-12-01 20:32:37,670 - INFO - No character metadata found; returning None for 'characters_per_image'.
2023-12-01 20:32:37,670 - INFO - Matching for noises ...
2023-12-01 20:32:42,366 - INFO - Noise extracting complete.
2023-12-01 20:32:42,366 - INFO - Current label count: {-1: 11, 0: 2, 1: 20, 7: 4, 10: 10, 12: 4, 13: 11, 14: 30, 23: 57, 24: 12, 25: 24, 26: 13, 27: 37, 28: 13, 29: 25, 30: 23, 31: 6, 32: 10, 33: 18, 34: 9, 35: 12, 36: 7}
2023-12-01 20:32:42,366 - INFO - Classifying using reference images ...
2023-12-01 20:32:49,151 - INFO - Classifying complete, remained cluster ids: [-1, 1, 6, 7, 10, 12, 13, 14, 23, 31, 32, 33, 34, 36].
2023-12-01 20:32:49,151 - INFO - Classifying using existing metadata characters ...
2023-12-01 20:32:49,152 - WARNING - Label 36 has multiple potential representative characters: [0 4].
2023-12-01 20:32:49,152 - INFO - Classifying complete, remained cluster ids: [-1, 0, 1, 2, 3, 6, 7, 10, 12, 13, 14, 33].
2023-12-01 20:32:49,152 - INFO - Matching for noises ...
2023-12-01 20:32:49,154 - INFO - Noise extracting complete.
2023-12-01 20:32:49,154 - INFO - Current label count: {-1: 11, 0: 8, 1: 73, 2: 25, 3: 9, 6: 5, 7: 11, 10: 12, 12: 4, 13: 24, 14: 176}
2023-12-01 20:32:49,154 - INFO - Filtering characters from images ...
2023-12-01 20:32:49,158 - INFO - Filtering complete.
2023-12-01 20:32:49,158 - INFO - Current label count: {-1.0: 38, 0.0: 7, 1.0: 73, 2.0: 25, 3.0: 9, 6.0: 5, 7.0: 11, 10.0: 11, 12.0: 4, 13.0: 24, 14.0: 151}
2023-12-01 20:32:49,159 - INFO - Saving classified images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/ref_images/hikikomari ...
2023-12-01 20:32:49,160 - INFO - class Terakomari has 8 images in total.
2023-12-01 20:32:49,162 - INFO - class Villhaze has 10 images in total.
2023-12-01 20:32:49,166 - INFO - class Sakuna has 10 images in total.
2023-12-01 20:32:49,170 - INFO - class Nelia has 9 images in total.
2023-12-01 20:32:49,173 - INFO - class KarenH has 5 images in total.
2023-12-01 20:32:49,174 - INFO - class Millicent has 7 images in total.
2023-12-01 20:32:49,176 - INFO - class Terakomari/none/pajama has 10 images in total.
2023-12-01 20:32:49,180 - INFO - class Terakomari/cone hair bun has 4 images in total.
2023-12-01 20:32:49,184 - INFO - class Terakomari/cone hair bun/red dress has 10 images in total.
2023-12-01 20:32:49,187 - INFO - class Terakomari/cone hair bun/uniform has 10 images in total.
2023-12-01 20:32:49,190 - INFO - Saving classified images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/classified ...
2023-12-01 20:32:49,190 - INFO - class 0_noise has 38 images in total.
2023-12-01 20:32:49,203 - INFO - class Terakomari has 7 images in total.
2023-12-01 20:32:49,205 - INFO - class Villhaze has 73 images in total.
2023-12-01 20:32:49,231 - INFO - class Sakuna has 25 images in total.
2023-12-01 20:32:49,240 - INFO - class Nelia has 9 images in total.
2023-12-01 20:32:49,243 - INFO - class KarenH has 5 images in total.
2023-12-01 20:32:49,245 - INFO - class Millicent has 11 images in total.
2023-12-01 20:32:49,249 - INFO - class Terakomari/none/pajama has 11 images in total.
2023-12-01 20:32:49,254 - INFO - class Terakomari/cone hair bun has 4 images in total.
2023-12-01 20:32:49,257 - INFO - class Terakomari/cone hair bun/red dress has 24 images in total.
2023-12-01 20:32:49,264 - INFO - class Terakomari/cone hair bun/uniform has 151 images in total.
2023-12-01 20:32:49,321 - INFO - -------------Start stage 4-------------
2023-12-01 20:32:49,321 - INFO - Loading mobilenetv3_large_100 ...
2023-12-01 20:32:49,651 - INFO - Preparing dataset images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru ...
2023-12-01 20:32:49,666 - INFO - Initialize metadata for raw images ...
2023-12-01 20:32:49,692 - INFO - Saving characters to metadata ...
2023-12-01 20:32:50,291 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/classified ...
2023-12-01 20:33:03,809 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 20:33:05,296 - INFO - Processing 0 no character images ...
2023-12-01 20:33:05,298 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru/classified' ...
2023-12-01 20:33:05,303 - INFO - Compute embeddings for 269 images ...
2023-12-01 20:33:07,222 - INFO - Removing similar images ...
2023-12-01 20:33:07,336 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru/raw' ...
2023-12-01 20:33:07,337 - INFO - Compute embeddings for 13 images ...
2023-12-01 20:33:08,066 - INFO - Removing similar images ...
2023-12-01 20:33:08,069 - INFO - -------------Start stage 5-------------
2023-12-01 20:33:08,309 - INFO - Tagging and captioning images in /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru ...
2023-12-01 20:36:02,526 - INFO - Search for core tags...
2023-12-01 20:36:03,658 - WARNING - Character 'ailan_lingzi' not found in core tag dictionary.
2023-12-01 20:36:03,943 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 20:36:07,975 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 20:36:08,041 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 20:36:08,057 - WARNING - Character 'lilithea' not found in core tag dictionary.
2023-12-01 20:36:08,088 - WARNING - Character 'ailan_lingzi' not found in core tag dictionary.
2023-12-01 20:36:08,244 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 20:36:08,382 - INFO - -------------Start stage 6-------------
2023-12-01 20:36:08,388 - INFO - Rearranging /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru ...
2023-12-01 20:36:08,882 - INFO - Constructing dictionary for auxiliary files...
2023-12-01 20:36:08,888 - INFO - Rearranging...
2023-12-01 20:36:11,096 - INFO - Constructing dictionary for auxiliary files...
2023-12-01 20:36:11,361 - INFO - Merging folders...
2023-12-01 20:36:11,361 - INFO - Millicent has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,395 - INFO - KarenH has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,418 - INFO - Millicent+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,427 - INFO - Nelia has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,485 - INFO - Terakomari+ailan_lingzi has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,485 - INFO - Sakuna+Terakomari+Villhaze has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,498 - INFO - Amatsu+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,507 - INFO - Sakuna+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,534 - INFO - Nelia+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,546 - INFO - Terakomari+lilithea has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,553 - INFO - Sakuna+Terakomari+ailan_lingzi has fewer than 10 images; renamed as character_others
2023-12-01 20:36:11,554 - INFO - Amatsu+Nelia+Sakuna+Terakomari+Villhaze has fewer than 10 images; renamed as character_others
2023-12-01 20:36:13,987 - INFO - -------------Start stage 7-------------
2023-12-01 20:36:13,987 - INFO - Computing repeat for /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training ...
2023-12-01 20:36:15,037 - INFO - Number of images: 966
2023-12-01 20:36:15,037 - INFO - Virtual dataset size: 3544.5099999999998
