2023-12-01 20:27:45,599 - INFO - -------------Start stage 1-------------
2023-12-01 20:27:46,878 - INFO - Loading mobilenetv3_large_100 ...
2023-12-01 20:27:47,849 - INFO - Extracting frames to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw ...
2023-12-01 20:27:47,980 - INFO - ['ffmpeg', '-hwaccel', 'cuda', '-i', '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/animes/[Erai-raws] Hikikomari Kyuuketsuki no Monmon - 07 [1080p][28FA99CC].mkv', '-vf', "select='eq(pict_type,I)'", '-vsync', 'vfr', '-qscale:v', '1', '-qmin', '1', '-c:a', 'copy', '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw/[Erai-raws] Hikikomari Kyuuketsuki no Monmon - 07 [1080p][28FA99CC]/hikikomariEP7_%d.png']
2023-12-01 20:28:45,091 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw/[Erai-raws] Hikikomari Kyuuketsuki no Monmon - 07 [1080p][28FA99CC]' ...
2023-12-01 20:28:45,098 - INFO - Compute embeddings for 385 images ...
2023-12-01 20:28:49,114 - INFO - Removing similar images ...
2023-12-01 20:28:50,879 - INFO - Removing op duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw' ...
2023-12-01 20:28:50,887 - INFO - Compute embeddings for 105 images ...
2023-12-01 20:28:52,689 - INFO - Removing similar images ...
2023-12-01 20:28:52,690 - INFO - Removing ed duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw' ...
2023-12-01 20:28:52,712 - INFO - Compute embeddings for 136 images ...
2023-12-01 20:28:54,629 - INFO - Removing similar images ...
2023-12-01 20:28:54,632 - INFO - -------------Start stage 2-------------
2023-12-01 20:28:54,633 - INFO - Cropping individual characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/cropped ...
2023-12-01 20:32:49,321 - INFO - -------------Start stage 3-------------
2023-12-01 20:32:49,321 - INFO - Classifying characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/classified ...
2023-12-01 20:32:49,347 - INFO - Extracting feature of 458 images ...
2023-12-01 20:33:29,368 - INFO - Clustering ...
2023-12-01 20:33:29,876 - INFO - Cluster complete, with 16 clusters.
2023-12-01 20:33:29,876 - INFO - Current label count: {-1: 277, 0: 8, 1: 8, 2: 12, 3: 7, 4: 10, 5: 6, 6: 25, 7: 24, 8: 5, 9: 10, 10: 16, 11: 5, 12: 10, 13: 14, 14: 5, 15: 5, 16: 11}
2023-12-01 20:33:29,878 - INFO - Extracting feature of 83 images ...
2023-12-01 20:33:29,897 - INFO - Matching for noises ...
2023-12-01 20:33:38,673 - INFO - Noise extracting complete.
2023-12-01 20:33:38,674 - INFO - Current label count: {-1: 77, 1: 4, 2: 3, 3: 16, 4: 21, 7: 37, 10: 20, 11: 23, 12: 60, 13: 20, 14: 24, 15: 6, 16: 27, 17: 24, 18: 11, 19: 10, 20: 19, 21: 11, 22: 10, 23: 14, 24: 5, 25: 5, 26: 11}
2023-12-01 20:33:38,674 - INFO - Classifying using reference images ...
2023-12-01 20:33:41,911 - INFO - Classifying complete, remained cluster ids: [-1, 1, 2, 3, 4, 5, 6, 7, 8, 16, 20, 21, 22, 23, 25, 26].
2023-12-01 20:33:41,911 - INFO - Matching for noises ...
2023-12-01 20:33:41,929 - INFO - Noise extracting complete.
2023-12-01 20:33:41,930 - INFO - Current label count: {-1: 173, 1: 5, 2: 3, 3: 16, 4: 125, 5: 35, 6: 5, 7: 80, 8: 16}
2023-12-01 20:33:41,930 - INFO - Filtering characters from images ...
2023-12-01 20:33:41,934 - INFO - Filtering complete.
2023-12-01 20:33:41,934 - INFO - Current label count: {-1.0: 177, 1.0: 5, 2.0: 3, 3.0: 16, 4.0: 124, 5.0: 33, 6.0: 5, 7.0: 80, 8.0: 15}
2023-12-01 20:33:41,934 - INFO - Saving classified images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/classified ...
2023-12-01 20:33:41,934 - INFO - class 0_noise has 177 images in total.
2023-12-01 20:33:42,388 - INFO - class Terakomari/none/pajama has 5 images in total.
2023-12-01 20:33:42,404 - INFO - class Terakomari/cone hair bun has 3 images in total.
2023-12-01 20:33:42,409 - INFO - class Terakomari/cone hair bun/red dress has 16 images in total.
2023-12-01 20:33:42,457 - INFO - class Terakomari/cone hair bun/uniform has 124 images in total.
2023-12-01 20:33:42,757 - INFO - class Sakuna has 33 images in total.
2023-12-01 20:33:42,863 - INFO - class KarenH has 5 images in total.
2023-12-01 20:33:42,883 - INFO - class Villhaze has 80 images in total.
2023-12-01 20:33:43,112 - INFO - class Millicent has 15 images in total.
2023-12-01 20:33:43,147 - INFO - -------------Start stage 4-------------
2023-12-01 20:33:43,148 - INFO - Loading mobilenetv3_large_100 ...
2023-12-01 20:33:43,392 - INFO - Preparing dataset images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots ...
2023-12-01 20:33:43,407 - INFO - Initialize metadata for raw images ...
2023-12-01 20:33:43,533 - INFO - Saving characters to metadata ...
2023-12-01 20:33:44,129 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/classified ...
2023-12-01 20:34:09,157 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw ...
2023-12-01 20:34:20,239 - INFO - Processing 374 no character images ...
2023-12-01 20:34:53,502 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots/no_characters' ...
2023-12-01 20:34:53,509 - INFO - Compute embeddings for 374 images ...
2023-12-01 20:34:55,947 - INFO - Removing similar images ...
2023-12-01 20:34:56,566 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots/classified' ...
2023-12-01 20:34:56,572 - INFO - Compute embeddings for 277 images ...
2023-12-01 20:34:58,478 - INFO - Removing similar images ...
2023-12-01 20:34:58,664 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots/raw' ...
2023-12-01 20:34:58,666 - INFO - Compute embeddings for 94 images ...
2023-12-01 20:35:00,153 - INFO - Removing similar images ...
2023-12-01 20:35:00,263 - INFO - -------------Start stage 5-------------
2023-12-01 20:35:00,310 - INFO - Tagging and captioning images in /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots ...
2023-12-01 20:36:13,750 - INFO - -------------Start stage 6-------------
2023-12-01 20:36:13,751 - INFO - Rearranging /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots ...
2023-12-01 20:36:13,812 - INFO - Constructing dictionary for auxiliary files...
2023-12-01 20:36:13,817 - INFO - Rearranging...
2023-12-01 20:36:13,950 - INFO - Constructing dictionary for auxiliary files...
2023-12-01 20:36:13,977 - INFO - Merging folders...
2023-12-01 20:36:13,977 - INFO - KarenH has fewer than 10 images; renamed as character_others
2023-12-01 20:36:13,978 - INFO - Sakuna+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 20:36:13,979 - INFO - Millicent+Sakuna has fewer than 10 images; renamed as character_others
2023-12-01 20:36:13,979 - INFO - Millicent+Terakomari has fewer than 10 images; renamed as character_others
