2023-12-02 01:59:37,251 - INFO - -------------Start stage 0-------------
2023-12-02 01:59:37,252 - INFO - Downloading animes to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/animes ...
2023-12-02 01:59:37,394 - INFO - Downloading [Erai-raws] Sousou no Frieren - 13 [720p][Multiple Subtitle] [ENG][POR-BR][SPA-LA][SPA][ARA][FRE][GER][ITA][RUS] ...
2023-12-02 02:01:06,159 - INFO - -------------Start stage 1-------------
2023-12-02 02:01:06,159 - INFO - Loading mobilenetv3_large_100 ...
2023-12-02 02:01:06,788 - INFO - Extracting frames to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw ...
2023-12-02 02:01:07,017 - INFO - ['ffmpeg', '-hwaccel', 'cuda', '-i', '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/animes/[Erai-raws] Sousou no Frieren - 13 [720p][Multiple Subtitle][302BF6E3].mkv', '-vf', "select='eq(pict_type,I)'", '-vsync', 'vfr', '-qscale:v', '1', '-qmin', '1', '-c:a', 'copy', '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw/[Erai-raws] Sousou no Frieren - 13 [720p][Multiple Subtitle][302BF6E3]/Sousou_no_Frieren_EP13_%d.png']
2023-12-02 02:02:04,347 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw/[Erai-raws] Sousou no Frieren - 13 [720p][Multiple Subtitle][302BF6E3]' ...
2023-12-02 02:02:04,371 - INFO - Compute embeddings for 1091 images ...
2023-12-02 02:02:12,996 - INFO - Removing similar images ...
2023-12-02 02:02:39,951 - INFO - Removing op duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw' ...
2023-12-02 02:02:39,964 - INFO - Compute embeddings for 223 images ...
2023-12-02 02:02:42,088 - INFO - Removing similar images ...
2023-12-02 02:02:42,089 - INFO - Removing ed duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw' ...
2023-12-02 02:02:42,133 - INFO - Compute embeddings for 200 images ...
2023-12-02 02:02:44,044 - INFO - Removing similar images ...
2023-12-02 02:02:44,047 - INFO - -------------Start stage 2-------------
2023-12-02 02:02:44,048 - INFO - Cropping individual characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/cropped ...
2023-12-02 02:12:32,200 - INFO - -------------Start stage 3-------------
2023-12-02 02:12:32,205 - INFO - Classifying characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/classified ...
2023-12-02 02:12:32,257 - INFO - Extracting feature of 462 images ...
2023-12-02 02:13:01,657 - INFO - No character metadata found; returning None for 'characters_per_image'.
2023-12-02 02:13:01,660 - INFO - Clustering ...
2023-12-02 02:13:02,370 - INFO - Cluster complete, with 17 clusters.
2023-12-02 02:13:02,370 - INFO - Current label count: {-1: 314, 0: 5, 1: 5, 2: 6, 3: 5, 4: 9, 5: 5, 6: 10, 7: 7, 8: 18, 9: 15, 10: 5, 11: 8, 12: 9, 13: 7, 14: 5, 15: 7, 16: 16, 17: 6}
2023-12-02 02:13:02,373 - INFO - Extracting feature of 166 images ...
2023-12-02 02:13:02,443 - INFO - Matching for noises ...
2023-12-02 02:13:09,848 - INFO - Noise extracting complete.
2023-12-02 02:13:09,849 - INFO - Current label count: {-1: 20, 6: 5, 7: 4, 10: 5, 11: 63, 12: 9, 13: 8, 14: 19, 15: 32, 16: 21, 17: 10, 18: 7, 19: 19, 20: 51, 21: 14, 22: 10, 23: 66, 24: 21, 25: 20, 26: 23, 27: 22, 28: 13}
2023-12-02 02:13:09,849 - INFO - Classifying using reference images ...
2023-12-02 02:13:29,968 - INFO - Classifying complete, remained cluster ids: [-1, 5, 6, 7, 9, 10, 23, 24, 25, 26, 27, 28].
2023-12-02 02:13:29,969 - INFO - Matching for noises ...
2023-12-02 02:13:29,982 - INFO - Noise extracting complete.
2023-12-02 02:13:29,983 - INFO - Current label count: {-1: 184, 5: 10, 6: 104, 7: 57, 9: 26, 10: 81}
2023-12-02 02:13:29,983 - INFO - Filtering characters from images ...
2023-12-02 02:13:29,986 - INFO - Filtering complete.
2023-12-02 02:13:29,987 - INFO - Current label count: {-1.0: 197, 5.0: 10, 6.0: 103, 7.0: 57, 9.0: 16, 10.0: 79}
2023-12-02 02:13:29,987 - INFO - Saving classified images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/classified ...
2023-12-02 02:13:29,987 - INFO - class 0_noise has 197 images in total.
2023-12-02 02:13:30,240 - INFO - class himmel_(sousou_no_frieren) has 10 images in total.
2023-12-02 02:13:30,250 - INFO - class frieren has 103 images in total.
2023-12-02 02:13:30,448 - INFO - class fern_(sousou_no_frieren) has 57 images in total.
2023-12-02 02:13:30,504 - INFO - class kraft_(sousou_no_frieren) has 16 images in total.
2023-12-02 02:13:30,527 - INFO - class stark_(sousou_no_frieren) has 79 images in total.
2023-12-02 02:13:30,682 - INFO - -------------Start stage 4-------------
2023-12-02 02:13:30,684 - INFO - Loading mobilenetv3_large_100 ...
2023-12-02 02:13:31,009 - INFO - Preparing dataset images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots ...
2023-12-02 02:13:31,042 - INFO - Initialize metadata for raw images ...
2023-12-02 02:13:31,511 - INFO - Saving characters to metadata ...
2023-12-02 02:13:32,502 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/classified ...
2023-12-02 02:13:52,643 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/screenshots/raw ...
2023-12-02 02:14:07,629 - INFO - Processing 500 no character images ...
2023-12-02 02:14:52,942 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots/no_characters' ...
2023-12-02 02:14:52,956 - INFO - Compute embeddings for 500 images ...
2023-12-02 02:14:56,909 - INFO - Removing similar images ...
2023-12-02 02:14:57,701 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots/classified' ...
2023-12-02 02:14:57,706 - INFO - Compute embeddings for 264 images ...
2023-12-02 02:14:59,438 - INFO - Removing similar images ...
2023-12-02 02:14:59,745 - INFO - Removing duplicates for '/home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots/raw' ...
2023-12-02 02:14:59,748 - INFO - Compute embeddings for 104 images ...
2023-12-02 02:15:01,303 - INFO - Removing similar images ...
2023-12-02 02:15:01,365 - INFO - -------------Start stage 5-------------
2023-12-02 02:15:01,442 - INFO - Tagging and captioning images in /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots ...
2023-12-02 02:16:35,099 - INFO - -------------Start stage 6-------------
2023-12-02 02:16:35,100 - INFO - Rearranging /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/screenshots ...
2023-12-02 02:16:35,191 - INFO - Constructing dictionary for auxiliary files...
2023-12-02 02:16:35,202 - INFO - Rearranging...
2023-12-02 02:16:35,427 - INFO - Constructing dictionary for auxiliary files...
2023-12-02 02:16:35,466 - INFO - Merging folders...
2023-12-02 02:16:35,467 - INFO - frieren+himmel_(sousou_no_frieren) has fewer than 10 images; renamed as character_others
2023-12-02 02:16:35,468 - INFO - frieren+stark_(sousou_no_frieren) has fewer than 10 images; renamed as character_others
2023-12-02 02:16:35,469 - INFO - fern_(sousou_no_frieren)+frieren has fewer than 10 images; renamed as character_others
2023-12-02 02:16:35,470 - INFO - kraft_(sousou_no_frieren)+stark_(sousou_no_frieren) has fewer than 10 images; renamed as character_others
2023-12-02 02:16:35,470 - INFO - himmel_(sousou_no_frieren)+stark_(sousou_no_frieren) has fewer than 10 images; renamed as character_others
