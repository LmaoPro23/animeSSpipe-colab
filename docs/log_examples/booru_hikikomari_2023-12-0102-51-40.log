2023-12-01 02:51:40,489 - INFO - -------------Start stage 0-------------
2023-12-01 02:51:40,490 - INFO - Downloading images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 02:51:40,490 - INFO - Downloading images for hikikomari_kyuuketsuki_no_monmon to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 02:52:00,654 - INFO - Downloading images for flote_mascarail to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 02:52:00,977 - INFO - -------------Start stage 1-------------
2023-12-01 02:52:00,978 - INFO - Removing duplicate images for /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 02:52:02,339 - INFO - Compute embeddings ...
2023-12-01 02:52:04,538 - INFO - Removing similar images ...
2023-12-01 02:52:04,540 - INFO - -------------Start stage 2-------------
2023-12-01 02:52:04,541 - INFO - Cropping individual characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/cropped ...
2023-12-01 02:53:06,244 - INFO - -------------Start stage 3-------------
2023-12-01 02:53:06,244 - INFO - Classifying characters to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/classified ...
2023-12-01 02:53:06,254 - INFO - Extracting feature of 149 images ...
2023-12-01 02:53:13,722 - INFO - Clustering ...
2023-12-01 02:53:13,795 - INFO - Cluster complete, with 7 clusters.
2023-12-01 02:53:13,795 - INFO - Current label count: {-1: 85, 0: 6, 1: 7, 2: 9, 3: 6, 4: 5, 5: 14, 6: 8, 7: 9}
2023-12-01 02:53:13,857 - INFO - Extracting feature of 253 images ...
2023-12-01 02:53:33,739 - INFO - Matching for noises ...
2023-12-01 02:53:35,648 - INFO - Noise extracting complete.
2023-12-01 02:53:35,649 - INFO - Current label count: {-1: 9, 1: 1, 3: 9, 19: 2, 20: 9, 22: 2, 24: 44, 25: 7, 26: 9, 27: 15, 28: 5, 29: 17, 30: 11, 31: 9}
2023-12-01 02:53:35,649 - INFO - Classifying using reference images ...
2023-12-01 02:53:38,767 - INFO - Classifying using existing metadata characters ...
2023-12-01 02:53:38,767 - WARNING - Label 25 has multiple potential representative characters: [1 2].
2023-12-01 02:53:38,767 - WARNING - Label 27 has multiple potential representative characters: [1 8].
2023-12-01 02:53:38,768 - INFO - Merging clusters ...
2023-12-01 02:53:38,768 - INFO - Merge complete, remained cluster ids: [0, 1, 3, 4, 6, 7, 19, 20, 22].
2023-12-01 02:53:38,768 - INFO - Current label count: {-1: 9, 0: 9, 1: 18, 3: 23, 4: 17, 6: 5, 7: 11, 19: 2, 20: 53, 22: 2}
2023-12-01 02:53:38,768 - INFO - Matching for noises ...
2023-12-01 02:53:38,769 - INFO - Noise extracting complete.
2023-12-01 02:53:38,769 - INFO - Current label count: {-1: 6, 0: 9, 1: 18, 3: 23, 4: 17, 6: 5, 7: 11, 19: 2, 20: 55, 22: 3}
2023-12-01 02:53:38,769 - INFO - Filtering characters from images ...
2023-12-01 02:53:38,771 - INFO - Filtering complete.
2023-12-01 02:53:38,771 - INFO - Current label count: {-1.0: 24, 0.0: 9, 3.0: 23, 4.0: 17, 6.0: 5, 7.0: 11, 19.0: 2, 20.0: 55, 22.0: 3}
2023-12-01 02:53:38,771 - INFO - class 0_noise has 24 images in total.
2023-12-01 02:53:38,779 - INFO - class Nelia has 9 images in total.
2023-12-01 02:53:38,782 - INFO - class Sakuna has 23 images in total.
2023-12-01 02:53:38,791 - INFO - class villhaze has 17 images in total.
2023-12-01 02:53:38,796 - INFO - class KarenH has 5 images in total.
2023-12-01 02:53:38,798 - INFO - class Millicent has 11 images in total.
2023-12-01 02:53:38,802 - INFO - class Terakomari/cone hair bun/red dress has 2 images in total.
2023-12-01 02:53:38,803 - INFO - class Terakomari/cone hair bun/uniform has 55 images in total.
2023-12-01 02:53:38,821 - INFO - class Terakomari/none/pajama has 3 images in total.
2023-12-01 02:53:38,823 - INFO - -------------Start stage 4-------------
2023-12-01 02:53:38,823 - INFO - Preparing dataset images to /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru ...
2023-12-01 02:53:38,832 - INFO - Initialize metadata for raw images ...
2023-12-01 02:53:38,848 - INFO - Saving characters to metadata ...
2023-12-01 02:53:39,274 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/classified ...
2023-12-01 02:53:44,649 - INFO - Processing images from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/intermediate/booru/raw ...
2023-12-01 02:53:45,244 - INFO - Copying 0 no character images ...
2023-12-01 02:53:45,245 - INFO - Removing duplicates from /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru ...
2023-12-01 02:53:46,428 - INFO - Compute embeddings ...
2023-12-01 02:53:53,548 - INFO - Removing similar images ...
2023-12-01 02:53:53,628 - INFO - Compute embeddings ...
2023-12-01 02:53:54,540 - INFO - Removing similar images ...
2023-12-01 02:53:54,542 - INFO - -------------Start stage 5-------------
2023-12-01 02:53:54,587 - INFO - Tagging and captioning images in /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru ...
2023-12-01 02:54:40,389 - INFO - Search for core tags...
2023-12-01 02:54:41,004 - WARNING - Character 'ailan_lingzi' not found in core tag dictionary.
2023-12-01 02:54:41,076 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 02:54:41,114 - WARNING - Character 'lilithea' not found in core tag dictionary.
2023-12-01 02:54:42,405 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 02:54:42,405 - WARNING - Character 'Terakomari' not found in core tag dictionary.
2023-12-01 02:54:42,434 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 02:54:42,460 - WARNING - Character 'ailan_lingzi' not found in core tag dictionary.
2023-12-01 02:54:42,460 - WARNING - Character 'Terakomari' not found in core tag dictionary.
2023-12-01 02:54:42,500 - WARNING - Character 'Amatsu' not found in core tag dictionary.
2023-12-01 02:54:42,516 - INFO - -------------Start stage 6-------------
2023-12-01 02:54:42,517 - INFO - Rearranging /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training/booru ...
2023-12-01 02:54:42,628 - INFO - Constructing dictionary for auxiliary files...
2023-12-01 02:54:42,629 - INFO - Rearranging...
2023-12-01 02:54:42,667 - INFO - Constructing dictionary for auxiliary files...
2023-12-01 02:54:42,676 - INFO - Merging folders...
2023-12-01 02:54:42,676 - INFO - Millicent has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,677 - INFO - KarenH has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,678 - INFO - Millicent+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,678 - INFO - Nelia has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,679 - INFO - Terakomari+ailan_lingzi has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,679 - INFO - Amatsu+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,679 - INFO - Terakomari+lilithea has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,679 - INFO - Terakomari+villhaze has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,680 - INFO - Sakuna+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,680 - INFO - Nelia+Terakomari has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,680 - INFO - Sakuna+Terakomari+ailan_lingzi has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,681 - INFO - Sakuna+Terakomari+villhaze has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,681 - INFO - Amatsu+Nelia+Sakuna+Terakomari+villhaze has fewer than 10 images; renamed as character_others
2023-12-01 02:54:42,683 - INFO - -------------Start stage 7-------------
2023-12-01 02:54:42,683 - INFO - Computing repeat for /home/sashi/Documents/Projects/Anime/extract-training-from-anime/data/training ...
2023-12-01 02:54:43,699 - INFO - Number of images: 202
2023-12-01 02:54:43,699 - INFO - Virtual dataset size: 1140.02
